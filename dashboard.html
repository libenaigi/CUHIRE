<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>CUHIRE ‚Äì Dashboard</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="css/dashboard.css" />
    <style>
      /* Simple styles for job cards */
      .jobs-section {
        margin: 20px 0;
      }
      .job-card {
        border: 1px solid #ccc;
        padding: 15px;
        margin-bottom: 10px;
        border-radius: 5px;
      }
      .job-card h4 {
        margin: 0 0 5px 0;
      }
      .job-card p {
        margin: 0 0 5px 0;
      }
      .job-card span {
        font-size: 0.9rem;
        color: #555;
        margin-right: 10px;
      }
    </style>
  </head>
  <body>
    <header class="header">
      <div class="logo-container">
        <img src="images/logo.png" alt="CUHIRE Logo" class="logo-img" />
        <span class="logo-text">CUHIRE</span>
      </div>
      <nav>
        <a href="jobportal.html">Find Jobs</a>
        <a href="login.html">Login</a>
        <a href="signup.html" class="btn-signup">Sign Up</a>
      </nav>
    </header>

    <main class="dashboard">
      <section class="welcome">
        <h2>Welcome to your Dashboard üëã</h2>
        <p>Here's what's happening with your job search today.</p>
      </section>

      <section class="stats">
        <div class="stat-box">
          <span>üìÅ</span>
          <p>Applied Jobs</p>
          <h3>12</h3>
        </div>
        <div class="stat-box">
          <span>üîñ</span>
          <p>Saved Jobs</p>
          <h3>8</h3>
        </div>
        <div class="stat-box">
          <span>‚è∞</span>
          <p>Profile Views</p>
          <h3>24</h3>
        </div>
        <div class="stat-box">
          <span>üîî</span>
          <p>Notifications</p>
          <h3>5</h3>
        </div>
      </section>

      <section class="jobs-section">
        <h3>Available Jobs</h3>
        <div id="jobs-container">
          </div>
      </section>
    </main>

    <footer class="footer">
      <div class="container footer-grid">
        <div class="footer-col">
          <div class="footer-logo">
            <img
              src="images/logo.png"
              alt="CUHIRE Logo"
              class="footer-logo-img"
            />
            <span>CUHIRE</span>
          </div>
          <p>
            Connecting talent with opportunity. Find your dream job or the
            perfect candidate.
          </p>
          <div class="socials">
            <a href="#">üê¶</a>
            <a href="#">üìò</a>
            <a href="#">üì∏</a>
            <a href="#">üîó</a>
          </div>
        </div>
        <div class="footer-col">
          <h4>For Job Seekers</h4>
          <ul>
            <li><a href="jobportal.html">Browse Jobs</a></li>
            <li><a href="dashboard.html">Dashboard</a></li>
            <li><a href="#">Applications</a></li>
            <li><a href="account.html">Profile Settings</a></li>
          </ul>
        </div>
        <div class="footer-col">
          <h4>For Recruiters</h4>
          <ul>
            <li><a href="post-job.html">Post a Job</a></li>
            <li><a href="recruiter-dashboard.html">Dashboard</a></li>
            <li><a href="#">Pricing</a></li>
            <li><a href="#">Resources</a></li>
          </ul>
        </div>
        <div class="footer-col">
          <h4>Company</h4>
          <ul>
            <li><a href="#">About Us</a></li>
            <li><a href="#">Contact</a></li>
            <li><a href="#">Privacy Policy</a></li>
            <li><a href="#">Terms of Service</a></li>
          </ul>
        </div>
      </div>
      <div class="footer-bottom">&copy; 2025 CUHIRE. All rights reserved.</div>
    </footer>

    <script>
      const token = localStorage.getItem("token");

      if (!token) {
        alert("Please login first!");
        window.location.href = "login.html";
      } else {
        fetch("https://cuhire-4.onrender.com/api/jobs", { // <-- THIS LINE IS UPDATED
          method: "GET",
          headers: {
            "Content-Type": "application/json",
            Authorization: "Bearer " + token,
          },
        })
          .then((res) => res.json())
          .then((result) => {
            const container = document.getElementById("jobs-container");
            const jobs = result.data; // use result.data
            if (!jobs || jobs.length === 0) {
              container.innerHTML = "<p>No jobs available.</p>";
              return;
            }

            jobs.forEach((job) => {
              const div = document.createElement("div");
              div.classList.add("job-card");
              div.innerHTML = `
                <h4>${job.title}</h4>
                <p>${job.description}</p>
                <span>${job.jobType}</span>
                <span>${job.location}</span>
                <span>Salary: ${job.formattedSalary || job.salary}</span>
                <span>Skills: ${job.skills.join(", ")}</span>
              `;
              container.appendChild(div);
            });
          })
          .catch((err) => {
            console.error(err);
            alert("Failed to fetch jobs from server");
          });
      }
    </script>
  </body>
</html>
